{% extends "base.html" %}

{% block css_extra %}
	<link rel="stylesheet" href="/media/css/formularios.css" type="text/css" />
	<link rel="stylesheet" href="/media/css/tablas.css" type="text/css" />
	<link rel="stylesheet" href="/media/css/juego/ligas/ver_liga.css" type="text/css" />
{% endblock %}

{% block js_extra %}
	<!--
	<script src="/media/js/tablesorter/jquery.tablesorter.min.js" type="text/javascript"></script>
	<script src="/media/js/tablesorter/jquery.tablesorter.pager.js" type="text/javascript"></script>
	-->
	<script type="text/javascript">
		jQuery(function($){
			$.datepicker.regional['es'] = {
				closeText: 'Cerrar',
				prevText: '&#x3c;Ant',
				nextText: 'Sig&#x3e;',
				currentText: 'Hoy',
				monthNames: ['Enero','Febrero','Marzo','Abril','Mayo','Junio',
				'Julio','Agosto','Septiembre','Octubre','Noviembre','Diciembre'],
				monthNamesShort: ['Ene','Feb','Mar','Abr','May','Jun',
				'Jul','Ago','Sep','Oct','Nov','Dic'],
				dayNames: ['Domingo','Lunes','Martes','Mi&eacute;rcoles','Jueves','Viernes','S&aacute;bado'],
				dayNamesShort: ['Dom','Lun','Mar','Mi&eacute;','Juv','Vie','S&aacute;b'],
				dayNamesMin: ['Do','Lu','Ma','Mi','Ju','Vi','S&aacute;'],
				weekHeader: 'Sm',
				dateFormat: 'dd/mm/yy',
				firstDay: 1,
				isRTL: false,
				showMonthAfterYear: false,
				yearSuffix: ''};
			$.datepicker.setDefaults($.datepicker.regional['es']);
		});

		$(document).ready(
			function() {
				/*$("#tabla_clasificacion")
				.tablesorter({widthFixed: true, widgets: ['zebra']})
				.tablesorterPager({container: $("#pager")});*/
				$("#id_fecha_nueva").datetimepicker();
			}
		);

	</script>
{% endblock %}

{% block contenido %}
	<h2>Liga "{{ liga.nombre }}"</h2>

	{% if activada %}
		{% if jornada_actual %}
			<h4>Jornada actual: <a href="/jornadas/ver/{{ jornada_actual.id }}/">{{ jornada_actual.numero }}</a></h4>

			{% if es_creador %}
				<!-- Esto es meramente para acelerar la presentacion del miercoles -->
				<form class="form1" id="form_ver_liga" action="/ligas/ver/" method="post">
					<h4>Avanzar tiempo</h4>

					{{ form_fecha.as_p }}
					<!-- Boton crear -->
					<div id="contenido_boton_crear">
						<input type="submit" value="Cambiar" />
					</div>
				</form>
			{% endif %}
		{% else %}
			<h4>FINALIZADA</h4>
		{% endif %}

		{% if clasificacion %}
			<!-- Tabla clasificacion -->
			<table class="tabla1" id="tabla_clasificacion">
				{% if liga_acabada %}
					<caption>Clasificación final</caption>
				{% else %}
					<caption>Clasificación (jornada {{ jornada_actual.numero }})</caption>
				{% endif %}

				<thead>
					<tr>
						<th title="Posici&oacute;n">Pos.</th>
						<th>Equipo</th>
						<th title="Partidos jugados">P.J.</th>
						<th title="Partidos ganados">P.G.</th>
						<th title="Partidos empatados">P.E.</th>
						<th title="Partidos perdidos">P.P.</th>
						<th title="Goles a favor">G.F.</th>
						<th title="Goles en contra">G.C.</th>
						<th title="Goles de diferencia">G.D.</th>
						<th>Puntos</th>
					</tr>
				</thead>
				<tbody>
					{% for dato_clasificacion in clasificacion %}
						{% if equipo_propio.nombre == dato_clasificacion.equipo.nombre %}
							<tr class="linea_equipo_propio">
						{% else %}
							<tr>
						{% endif %}
							<!-- Posicion -->
							<td class="num1">
								{{ dato_clasificacion.posicion }}
							</td>
							<!-- Equipo -->
							<td>
								<a href="/equipos/ver/{{ dato_clasificacion.equipo.id }}/">{{ dato_clasificacion.equipo.nombre }}</a>
							</td>
							<!-- Partidos jugados -->
							<td class="num1">
								{{ dato_clasificacion.partidos_jugados }}
							</td>
							<!-- Partidos ganados -->
							<td class="num1">
								{{ dato_clasificacion.partidos_ganados }}
							</td>
							<!-- Partidos empatados -->
							<td class="num1">
								{{ dato_clasificacion.partidos_empatados }}
							</td>
							<!-- Partidos perdidos -->
							<td class="num1">
								{{ dato_clasificacion.partidos_perdidos }}
							</td>
							<!-- Goles a favor -->
							<td class="num1">
								{{ dato_clasificacion.goles_favor }}
							</td>
							<!-- Goles en contra -->
							<td class="num1">
								{{ dato_clasificacion.goles_contra }}
							</td>
							<!-- Goles de diferencia -->
							<td class="num1">
								{{ dato_clasificacion.goles_diferencia }}
							</td>
							<!-- Puntos -->
							<td class="num1">
								{{ dato_clasificacion.puntos }}
							</td>
						</tr>
					{% endfor %}
				</tbody>
			</table>

			<!-- Paginacion
			<div id="pager" class="pager">
				<form>
					<img src="../addons/pager/icons/first.png" class="first"/>
					<img src="../addons/pager/icons/prev.png" class="prev"/>
					<input type="text" class="pagedisplay"/>
					<img src="../addons/pager/icons/next.png" class="next"/>
					<img src="../addons/pager/icons/last.png" class="last"/>
					<select class="pagesize">
						<option selected="selected"  value="10">10</option>

						<option value="20">20</option>
						<option value="30">30</option>
						<option  value="40">40</option>
					</select>
				</form>
			</div>-->
		{% endif %}

		<!-- Tabla jornadas -->
		<table class="tabla1" id="tabla_jornadas">
			<caption>Listado de jornadas</caption>
			<thead>
				<tr>
					<th>Jornada</th>
					<th>Fecha inicio</th>
					<th>Fecha fin</th>
					<th>Jugada</th>
				</tr>
			</thead>
			<tbody>
				{% for jornada in jornadas %}
					<tr>
						<td class="cuadro_num_azul_der">
							<a href="/jornadas/ver/{{ jornada.id }}/">{{ jornada.numero }}</a>
						</td>
						<td>
							{{ jornada.fecha_inicio }}
						</td>
						<td>
							{{ jornada.fecha_fin }}
						</td>
						<th>
							{% if jornada.jugada %}
								<span class="jornada_jugada">SÍ</span>
							{% else %}
								<span class="jornada_no_jugada">NO</span>
							{% endif %}
						</th>
					</tr>
				{% endfor %}
			</tbody>
		</table>
	{% else %}
		<div id="activar_liga">
			<span>La liga no está activada aún:</span>
			{% if es_creador %}
				<a href="/ligas/activar/">ACTIVAR</a>
			{% endif %}
		</div>

		<div id="equipo_propio">
			{% if equipo_propio %}
				Equipo propio: <a href="/equipos/ver/{{ equipo_propio.id }}/">{{ equipo_propio.nombre }}</a>
			{% else %}
				<b>{{ user.username }}</b> aún puede <a href="/equipos/crear/">crear un equipo</a> en esta liga.
			{% endif %}
		</div>
	{% endif %}

	<!-- Tabla de equipos -->
	<table class="tabla1" id="tabla_equipos">
		<caption>Listado de equipos</caption>
		{% if equipos %}
			<thead>
				<tr>
					<th>Nombre</th>
					<th>Entrenador</th>
				</tr>
			</thead>
			<tbody>
				{% for equipo in equipos %}
					<tr {% if equipo_propio.nombre == equipo.nombre %}
							class="linea_equipo_propio"
						{% endif %}>

						<td>
							<a href="/equipos/ver/{{ equipo.id }}/">{{ equipo.nombre }}</a>
						</td>
						<td>
							{% if equipo.usuario %}
								{{ equipo.usuario }}
							{% else %}
								Usuario Artificial
							{% endif %}
						</td>
					</tr>
				{% endfor %}
			</tbody>
		{% else %}
			<tr>
				<th>Aún no se ha añadido ningún equipo a la liga</th>
			</tr>
		{% endif %}
	</table>

{% endblock %}
